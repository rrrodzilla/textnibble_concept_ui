#:kivy 2.0.0
#:import RoundedRectangle kivy.graphics
#:import C kivy.utils.get_color_from_hex
#:import LiveOrdersScreen liveordersscreen
#:include liveordersscreen.kv
#:import PreviousOrdersScreen previousordersscreen
#:include previousordersscreen.kv
#:import OrderDetailScreen orderdetailscreen
#:include orderdetailscreen.kv
#:import ActiveOrdersScreen activeordersscreen
#:include activeordersscreen.kv
#:import WorkingOrdersScreen workingordersscreen
#:include workingordersscreen.kv
#:import AlertButton alertbutton
#:include alertbutton.kv
#:import OrdersScreenManager ordersscreenmanager

<AlertButton>
    size_hint: .1, 1
<MainScreen>:
#    content_manager: content_manager
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, None
            height: 96
            padding: 96, 0, 96, 0
            StackLayout:
                Image:
                    source: './images/logo-horizontal-reversed@3x.png'
                    color: C('#A1A1AA')
                    size_hint: .15, 1
                    allow_stretch: True
                AlertButton:
                    id: alert_button_urgent
                    on_press: content_manager.current = 'urgent_orders'
                    button_text: '[i]Action Needed[/i]'
                    badge_total: len(content_manager.order_manager.urgent_orders)
                AlertButton:
                    on_press: content_manager.current = 'working_orders'
                    button_text: 'Working Orders'
                    badge_total: len(content_manager.order_manager.working_orders)
                AlertButton:
                    on_press: content_manager.current = 'awaiting_pickup'
                    button_text: 'Awaiting Pickup'
                    badge_total: len(content_manager.order_manager.awaiting_pickup_orders)
                AlertButton:
                    on_press: content_manager.current = 'idle_orders'
                    button_text: 'Idle Orders'
                    badge_total: len(content_manager.order_manager.idle_orders)
                AlertButton:
                    on_press: content_manager.current = 'fulfilled'
                    button_text: 'Past Orders'
                    badge_total: len(content_manager.order_manager.fulfilled)
#                AlertButton:
#                    on_press: content_manager.current = 'all_orders'
#                    button_text: 'All Orders'
#                    badge_total: len(content_manager.order_manager.all_orders)
                AlertButton:
                    on_press: content_manager.order_manager.add_dummy_order()
                    button_text: 'Add Order'
                    badge_total: 0
            AnchorLayout:
                anchor_y: 'center'
                anchor_x: 'center'
                size_hint: .1, 1
                Button:
                    canvas.before:
                        Color:
                            rgb: C('#D4D4D8')
                        Ellipse:
                            size: self.size
                            pos: self.pos
                    background_color: 0, 0, 0, 0
                    markup: True
                    text: f'[font=Icons][size=24]{chr(60558)}[/size][/font]'
                    color: C('#71717A')
                    size_hint_x: None
                    size_hint_y: None
                    height: 48
                    width: 48
                    on_press: root.manager.current = 'login'
        OrdersScreenManager:
            id: content_manager
            LiveOrdersScreen:
                id: live_orders
                name: 'urgent_orders'
                orders: self.manager.order_manager.urgent_orders
            LiveOrdersScreen:
                id: working_orders
                name: 'working_orders'
                orders: self.manager.order_manager.working_orders
            LiveOrdersScreen:
                id: awaiting_pickup
                name: 'awaiting_pickup'
                orders: self.manager.order_manager.awaiting_pickup_orders
            LiveOrdersScreen:
                id: idle_orders
                name: 'idle_orders'
                orders: self.manager.order_manager.idle_orders
            LiveOrdersScreen:
                id: fulfilled
                name: 'fulfilled'
                orders: self.manager.order_manager.fulfilled
#            LiveOrdersScreen:
#                id: all_orders
#                name: 'all_orders'
#                orders: self.manager.order_manager.all_orders
#                content_manager.on_orders_loaded: print(f'orders loaded')

#            ActiveOrdersScreen:
#                id: active_orders
#                screen_manager: content_manager
#            WorkingOrdersScreen:
#                id: working_orders
#                screen_manager: content_manager
#            PreviousOrdersScreen:
#                id: previous_orders
            OrderDetailScreen:
                id: order_detail
